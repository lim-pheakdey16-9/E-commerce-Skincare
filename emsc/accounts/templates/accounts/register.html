{% extends 'accounts/main/web/app.html' %}
{% load static %}
{% block content %}
<style>
    .alert{
        color: red;
    }
</style>
  <main class="pt-90">
    <div class="mb-4 pb-4"></div>
    <div class="container py-5">
      <div class="row justify-content-center">
        <div class="col-md-8 col-lg-6">
          <div class="card shadow">
            <div class="card-body p-5">
              <h2 class="card-title text-center mb-4">Register</h2>

              {% if messages %}
                <div class="alert-messages">
                  {% for message in messages %}
                    <div class="alert {% if message.tags %}
                        alert-{{ message.tags }}
                      {% else %}
                        alert-info
                      {% endif %}">{{ message }}</div>
                  {% endfor %}
                </div>
              {% endif %}

              <form method="POST" action="{% url 'register' %}" class="needs-validation" novalidate>
                {% csrf_token %}

                <div class="row">
                  <div class="col-md-6 mb-3">
                    <div class="form-floating">
                      <input type="text" class="form-control" id="first_name" name="first_name" value="{{ request.POST.first_name }}" required autocomplete="given-name" />
                      <label for="first_name">First Name *</label>
                      <div class="invalid-feedback">Please enter your first name.</div>
                    </div>
                  </div>
                  <div class="col-md-6 mb-3">
                    <div class="form-floating">
                      <input type="text" class="form-control" id="last_name" name="last_name" value="{{ request.POST.last_name }}" required autocomplete="family-name" />
                      <label for="last_name">Last Name *</label>
                      <div class="invalid-feedback">Please enter your last name.</div>
                    </div>
                  </div>
                </div>

                <div class="mb-3">
                  <div class="form-floating">
                    <input type="text" class="form-control" id="username" name="username" value="{{ request.POST.username }}" required autocomplete="username" />
                    <label for="username">Username *</label>
                    <div class="invalid-feedback">Please choose a username.</div>
                  </div>
                </div>

                <div class="mb-3">
                  <div class="form-floating">
                    <input type="email" class="form-control" id="email" name="email" value="{{ request.POST.email }}" required autocomplete="email" />
                    <label for="email">Email *</label>
                    <div class="invalid-feedback">Please enter a valid email address.</div>
                  </div>
                </div>

                <div class="mb-3">
                  <div class="form-floating">
                    <input type="password" class="form-control" id="password" name="password" required autocomplete="new-password" minlength="8" />
                    <label for="password">Password *</label>
                    <div class="invalid-feedback">Password must be at least 8 characters.</div>
                  </div>
                </div>

                <div class="mb-4">
                  <div class="form-floating">
                    <input type="password" class="form-control" id="con_password" name="con_password" required autocomplete="new-password" minlength="8" />
                    <label for="con_password">Confirm Password *</label>
                    <div class="invalid-feedback">Passwords must match.</div>
                  </div>
                </div>

                <button class="btn btn-primary w-100 py-2 mb-3" type="submit">Register</button>

                <div class="customer-option mt-4 text-center">
                <span class="text-secondary">You have account yet?</span>
                <a href="{% url 'login' %}" class="btn-text js-show-register">Login Account</a>
              </div>    
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
  <script>
     
    ;(function () {
      'use strict'
      window.addEventListener(
        'load',
        function () {
          var forms = document.getElementsByClassName('needs-validation')
          Array.prototype.filter.call(forms, function (form) {
            form.addEventListener(
              'submit',
              function (event) {
                if (form.checkValidity() === false) {
                  event.preventDefault()
                  event.stopPropagation()
                }
                form.classList.add('was-validated')
              },
              false
            )
          })
        },
        false
      )
    })()
    
     
    document.getElementById('con_password').addEventListener('input', function () {
      const password = document.getElementById('password').value
      const confirmPassword = this.value
      const feedback = this.nextElementSibling.nextElementSibling
    
      if (password !== confirmPassword) {
        this.setCustomValidity('Passwords must match.')
        feedback.style.display = 'block'
      } else {
        this.setCustomValidity('')
        feedback.style.display = 'none'
      }
    })
  </script>
{% endblock %}
